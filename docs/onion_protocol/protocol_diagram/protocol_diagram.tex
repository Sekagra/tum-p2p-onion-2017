\documentclass{standalone}
\usepackage[underline=true]{pgf-umlsd}
\usetikzlibrary{calc}

\begin{document}
\begin{sequencediagram}

    \newinst{ot}{OT}
    \newinst[10]{ih1}{$IH_1$}
    \newinst[9]{ih2}{$IH_2$}
    \newinst[7]{r}{R}

    \begin{sdblock}{TunnelBuild}{Building a tunnel from OT to the rendevouz point}
        \mess{ot}{init[$LID_1$T, payload]}{ih1}
        \mess{ih1}{accept[$LID_1$, payload]}{ot}

        \mess{ot}{relay[$LID_1$, $E_{LID_2}${(}$LID_2$, $IH_2$, init[$LID_2$, payload]{)}]}{ih1}
        \mess{ih1}{init[$LID_2$, payload]}{ih2}
        \mess{ih2}{accept[$LID_2$, payload]}{ih1}
        \mess{ih1}{data[$LID_1$, $E_{LID_1}${(}$LID_2$, accept[$LID_2$, payload]{)}]}{ot}

        \mess{ot}{data[$LID_1$, $E_{LID_1}${(}relay[$LID_2$, $E_{LID_2}${(}$LID_R$, R, init[$LID_R$, payload]{)}]{)}]}{ih1}
        \mess{ih1}{relay[$LID_2$, $E_{LID_2}${(}$LID_R$, R, init[$LID_R$, payload]{)}]}{ih2}
        \mess{ih2}{init[$LID_R$, payload]}{r}
        \mess{r}{accept[$LID_R$, payload]}{ih2}
        \mess{ih2}{data[$LID_2$, $E_{LID_2}${(}accept[$LID_R$, payload]{)}]}{ih1}
        \mess{ih1}{data[$LID_1$, $E_{LID_1}${(}data[$LID_2$, $E_{LID_2}${(}accept[$LID_R$, payload]{)}]{)}]}{ot}
    \end{sdblock}

    \begin{sdblock}{TunnelData}{Sending data from OT to the rendevouz point}
        \mess{ot}{data[$LID_1$, $E_{LID_1}${(}data[$LID_2$, $E_{LID_2}${(}data[$LID_R$, $E_{LID_R}${(}"Hello"{)}]{)}]{)}]}{ih1}
        \mess{ih1}{data[$LID_2$, $E_{LID_2}${(}data[$LID_R$, $E_{LID_R}${(}"Hello"{)}]{)}]}{ih2}
        \mess{ih2}{data[$LID_R$, $E_{LID_R}${(}"Hello"{)}]}{r}
        \mess{r}{data[$LID_R$, $E_{LID_R}${(}"World"{)}]}{ih2}
        \mess{ih2}{data[$LID_2$, $E_{LID_2}${(}data[$LID_R$, $E_{LID_R}${(}"World"{)}]{)}]}{ih1}
        \mess{ih1}{data[$LID_1$, $E_{LID_1}${(}data[$LID_2$, $E_{LID_2}${(}data[$LID_R$, $E_{LID_R}${(}"World"{)}]{)}]{)}]}{ot}
    \end{sdblock}

    \begin{sdblock}{TunnelTeardown}{Controlled tunnel teardown}
        \mess{ot}{data[$LID_1$, $E_{LID_1}${(}data[$LID_2$, $E_{LID_2}${(}teardown[$LID_R$, $E_{LID_R}${(}$ts_{OT}${)}]{)}]{)}]}{ih1}
        \mess{ih1}{data[$LID_2$, $E_{LID_2}${(}teardown[$LID_R$, $E_{LID_R}${(}$ts_{OT}${)}]{)}]}{ih2}
        \mess{ih2}{teardown[$LID_R$, $E_{LID_R}${(}$ts_{OT}${)}]}{r}
        \mess{r}{teardown[$LID_R$, $E_{LID_R}${(}$ts_{R}${)}]}{ih2}
        \mess{ih2}{teardown[$LID_2$, $E_{LID_2}${(}$ts_{IH_2}${)}]}{ih1}
        \mess{ih1}{teardown[$LID_1$, $E_{LID_1}${(}$ts_{IH_1}${)}]}{ot}
    \end{sdblock}

\end{sequencediagram}
\end{document}
